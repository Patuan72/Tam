
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Speaking PWA</title>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    .sentence { font-size: 20px; font-weight: bold; margin-bottom: 20px; }
    .score { font-size: 24px; margin-top: 10px; color: green; }
    .transcript { margin-top: 10px; font-style: italic; color: gray; }
    button { font-size: 20px; padding: 10px 20px; }
  </style>
</head>
<body>
  <div class="sentence">Hello, how are you?</div>
  <button id="mic">ðŸŽ¤ Speak</button>
  <div class="transcript"></div>
  <div class="score">Score: --</div>

  <script>
    function compareSentences(expected, actual) {
      const clean = str => str.toLowerCase().replace(/[^a-z0-9 ]/g, "").trim();
      const expectedWords = clean(expected).split(" ");
      const actualWords = clean(actual).split(" ");
      let match = 0;
      expectedWords.forEach((word, i) => {
        if (actualWords[i] && actualWords[i] === word) match++;
      });
      const score = Math.round((match / expectedWords.length) * 100);
      return score;
    }

    const micBtn = document.getElementById("mic");
    const sentenceBox = document.querySelector(".sentence");
    const transcriptBox = document.querySelector(".transcript");
    const scoreBox = document.querySelector(".score");

    let recognition;
    if ("webkitSpeechRecognition" in window || "SpeechRecognition" in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.lang = "en-US";
      recognition.interimResults = false;

      recognition.onresult = event => {
        const transcript = event.results[0][0].transcript;
        transcriptBox.textContent = "You said: " + transcript;
        const score = compareSentences(sentenceBox.textContent, transcript);
        scoreBox.textContent = "Score: " + score;
      };

      recognition.onerror = e => {
        transcriptBox.textContent = "âŒ Error: " + e.error;
      };
    }

    micBtn.onclick = () => {
      transcriptBox.textContent = "Listening...";
      recognition.start();
    };
  </script>
</body>
</html>
